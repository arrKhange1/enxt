@let fwbDetailsConfig = reportFieldsConfig.fwbDetails;

<mat-table class="report-table" matSort (matSortChange)="sortChange($event)" [dataSource]="reportData()">
  <ng-container matColumnDef="prefix">
    <mat-header-cell  *matHeaderCellDef>{{ fwbDetailsConfig.prefix }}</mat-header-cell>
    <mat-cell *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.AWB_Prefix}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="serial">
    <mat-header-cell  mat-sort-header *matHeaderCellDef>{{ fwbDetailsConfig.serial }}</mat-header-cell>
    <mat-cell  *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.AWB_Serial}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="origin">
    <mat-header-cell  mat-sort-header *matHeaderCellDef>{{ fwbDetailsConfig.origin }}</mat-header-cell>
    <mat-cell  *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.AWB_Origin}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="destination">
    <mat-header-cell  mat-sort-header *matHeaderCellDef>{{ fwbDetailsConfig.destination }}</mat-header-cell>
    <mat-cell  *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.AWB_Destination}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="act_weight">
    <mat-header-cell  mat-sort-header *matHeaderCellDef>{{ fwbDetailsConfig.weight }}</mat-header-cell>
    <mat-cell  *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.Weight_Actual}} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="unit">
    <mat-header-cell mat-sort-header *matHeaderCellDef>{{ fwbDetailsConfig.weightId }}</mat-header-cell>
    <mat-cell  *matCellDef="let fwbRow"> {{fwbRow.fWB_Details.Weight_Identifier}} </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="columnsToDisplay"></mat-header-row>
  <mat-row
    class="report-table__row"
    (click)="expandRowContent(fwbRow)"
    [attr.data-agent]="fwbRow.agent_Details"
    *matRowDef="let fwbRow; columns: columnsToDisplay"
    [ngTemplateOutlet]="rowContent"
    [ngTemplateOutletContext]="{ $implicit: fwbRow }"
  >
  </mat-row>


  <ng-template #rowContent let-fwbRow>
    @if (expandedRow === fwbRow) {
      <div class="row__more-info">
        <app-fwb-detail-card [fwbDetails]="fwbRow.fWB_Details" />
        @if (fwbRow.agent_Details) {
          <app-agent-detail-card [agentDetails]="fwbRow.agent_Details" />
        }
        <app-shipper-detail-card [shipperDetails]="fwbRow.shipper_Details" />
      </div>
    }
  </ng-template>

</mat-table>
